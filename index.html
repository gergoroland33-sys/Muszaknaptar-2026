<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Műszaknaptár 2026</title>
<style>
body { font-family: Arial, sans-serif; margin:10px; background:#f7f7f7; }
h2 { text-align:center; margin-bottom:10px; }
select, button { width:100%; padding:5px; margin:5px 0; font-size:16px; }
.card { background:white; margin:5px 0; padding:10px; border-radius:6px; box-shadow:0 1px 3px rgba(0,0,0,0.15);}
.date-title { font-weight:bold; margin-bottom:5px; }
.muszak-A, .muszak-B { background:#a0c4ff; color:black; margin:2px 0; padding:4px; border-radius:4px; } /* Nappal */
.muszak-C, .muszak-D { background:#d0b3ff; color:black; margin:2px 0; padding:4px; border-radius:4px; } /* Éjszaka */
.highlight { border:2px solid #ff3c38; padding:8px; border-radius:6px; }
</style>
</head>
<body>

<h2>Műszaknaptár 2026</h2>

<label>Hónap:</label>
<select id="honap">
<option value="mind">Mind</option>
<option value="01">Január</option>
<option value="02">Február</option>
<option value="03">Március</option>
<option value="04">Április</option>
<option value="05">Május</option>
<option value="06">Június</option>
<option value="07">Július</option>
<option value="08">Augusztus</option>
<option value="09">Szeptember</option>
<option value="10">Október</option>
<option value="11">November</option>
<option value="12">December</option>
</select>

<label>Műszak:</label>
<select id="muszak">
<option value="mind">Mind</option>
<option value="A">A</option>
<option value="B">B</option>
<option value="C">C</option>
<option value="D">D</option>
</select>

<button id="goto-today">Mai napra ugrás</button>

<div id="eredmeny">Adatok betöltése…</div>

<script>
let muszakok = [];

// CSV betöltése
fetch('muszakok.csv')
.then(r => r.text())
.then(text => {
muszakok = [];
const sorok = text.split('\n').slice(1);
sorok.forEach(sor => {
const cols = sor.split(';').map(c => c.trim()).filter(c => c!=='');
for(let i=0; i+3<cols.length; i+=4){
const datum = cols[i].replace(/\./g,'-'); // YYYY-MM-DD
const nev = cols[i+1];
const nap = cols[i+2];
const muszak = cols[i+3].toUpperCase();
if(datum && nev && muszak){
muszakok.push({datum, nev, nap, muszak});
}
}
});
showData();
});

// Megjelenítés dátum szerint csoportosítva
function showData(){
const honapValaszt = document.getElementById('honap').value;
const muszakValaszt = document.getElementById('muszak').value;

let html = '';
const today = new Date();
const todayStr = today.toISOString().split('T')[0]; // YYYY-MM-DD

let talalatok = muszakok;

if(honapValaszt!=='mind'){
talalatok = talalatok.filter(r => r.datum.slice(5,7)===honapValaszt);
}
if(muszakValaszt!=='mind'){
talalatok = talalatok.filter(r => r.muszak===muszakValaszt.toUpperCase());
}

// Csoportosítás dátum szerint
const dates = [...new Set(talalatok.map(r=>r.datum))].sort();

if(dates.length===0){
html='<div class="card">Nincs adat a kiválasztott szűrésre</div>';
} else {
dates.forEach(datum=>{
const aznap = talalatok.filter(r=>r.datum===datum);
const highlight = datum===todayStr ? 'highlight' : '';
html += `<div class="card ${highlight}"><div class="date-title">${datum} (${aznap[0].nap})</div>`;
aznap.forEach(r=>{
html += `<div class="muszak-${r.muszak}">${r.nev} – ${r.muszak} műszak</div>`;
});
html += '</div>';
});
}

document.getElementById('eredmeny').innerHTML = html;

// Automatikus görgetés az aktuális naphoz
const kiemelt = document.querySelector('.highlight');
if(kiemelt){
kiemelt.scrollIntoView({behavior:'smooth', block:'center'});
}
}

// Mai nap gomb
document.getElementById('goto-today').addEventListener('click', ()=>{
const kiemelt = document.querySelector('.highlight');
if(kiemelt){
kiemelt.scrollIntoView({behavior:'smooth', block:'center'});
}
});

document.getElementById('honap').addEventListener('change', showData);
document.getElementById('muszak').addEventListener('change', showData);
</script>

</body>
</html>
