<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Műszaknaptár 2026</title>
<style>
body { font-family: Arial, sans-serif; margin:10px; background:#f7f7f7; }
h2 { text-align:center; }
select { width:100%; padding:5px; margin:5px 0; font-size:16px; }
.card { background:white; margin:5px 0; padding:10px; border-radius:6px; box-shadow:0 1px 3px rgba(0,0,0,0.15);}
.muszak-A { background:#bbdefb; color:black; }
.muszak-B { background:#c8e6c9; color:black; }
.muszak-C { background:#fff9c4; color:black; }
.muszak-D { background:#ffe0b2; color:black; }
.highlight { border:2px solid red; padding:8px; border-radius:6px; }
.gomb { padding:6px 12px; margin:5px 0; font-size:14px; cursor:pointer; background:#1976d2; color:white; border:none; border-radius:4px; }
</style>
</head>
<body>

<h2>Műszaknaptár 2026</h2>

<label>Hónap:</label>
<select id="honap">
<option value="mind">Mind</option>
<option value="01">Január</option>
<option value="02">Február</option>
<option value="03">Március</option>
<option value="04">Április</option>
<option value="05">Május</option>
<option value="06">Június</option>
<option value="07">Július</option>
<option value="08">Augusztus</option>
<option value="09">Szeptember</option>
<option value="10">Október</option>
<option value="11">November</option>
<option value="12">December</option>
</select>

<label>Műszak:</label>
<select id="muszak">
<option value="mind">Mind</option>
<option value="A">A</option>
<option value="B">B</option>
<option value="C">C</option>
<option value="D">D</option>
</select>

<button class="gomb" id="maigomb">Ugrás a mai napra</button>

<div id="eredmeny">Adatok betöltése…</div>

<script>
let muszakok = [];

// Műszakvezetők
const vezetok = {
'A': 'Czerovszki Zsolt',
'B': 'Hajdu Zoltán',
'C': 'Kamasz Ádám',
'D': 'Komjáti István'
};

// CSV betöltése
fetch('muszakok.csv')
.then(r => r.text())
.then(text => {
muszakok = [];
// minden sor feldolgozása
text.split('\n').slice(1).forEach(line => {
line = line.trim();
if(!line) return;
// egy sorban több műszak lehet
let parts = line.split(';;').map(p=>p.trim()).filter(p=>p);
parts.forEach(p=>{
const col = p.split(';').map(e=>e.trim());
if(col.length>=4){
muszakok.push({
datum: col[0],
hely: col[1],
nap: col[2],
muszak: col[3]
});
}
});
});
showData();
});

// Dátumok szerint csoportosítás, szűrés
function showData() {
const honapValaszt = document.getElementById('honap').value;
const muszakValaszt = document.getElementById('muszak').value;

let html = '';
const today = new Date();
const todayStr = today.toISOString().split('T')[0]; // YYYY-MM-DD

let talalatok = muszakok;

if(honapValaszt!=='mind'){
talalatok = talalatok.filter(r => r.datum.slice(5,7)===honapValaszt);
}

if(muszakValaszt!=='mind'){
talalatok = talalatok.filter(r => r.muszak===muszakValaszt);
}

if(talalatok.length===0){
html='<div class="card">Nincs adat a kiválasztott szűrésre</div>';
} else {
// Dátum szerint csoportosítás
const napok = {};
talalatok.forEach(r=>{
if(!napok[r.datum]) napok[r.datum]=[];
napok[r.datum].push(r);
});

Object.keys(napok).sort().forEach(datum=>{
html += `<div class="card highlight">${datum}</div>`;
napok[datum].forEach(r=>{
let muszakNev = r.muszak;
if(muszakValaszt!=='mind'){ // szűrt nézetben mutassuk a vezetőt
muszakNev += ` (${vezetok[r.muszak]})`;
}
html += `<div class="card muszak-${r.muszak}">
<strong>${r.hely}</strong> – ${muszakNev} – ${r.nap}
</div>`;
});
});
}

document.getElementById('eredmeny').innerHTML = html;

// automatikus scroll a mai naphoz
const maElem = Array.from(document.querySelectorAll('.highlight')).find(el=>el.textContent===todayStr);
if(maElem){
maElem.scrollIntoView({behavior:'smooth', block:'center'});
}
}

// Szűrők eseményei
document.getElementById('honap').addEventListener('change', showData);
document.getElementById('muszak').addEventListener('change', showData);
document.getElementById('maigomb').addEventListener('click', showData);
</script>

</body>
</html>
